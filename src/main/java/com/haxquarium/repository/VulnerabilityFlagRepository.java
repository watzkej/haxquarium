package com.haxquarium.repository;

import com.haxquarium.model.VulnerabilityFlag;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.stereotype.Repository;

import java.util.List;
import java.util.Optional;

/**
 * Repository interface for VulnerabilityFlag entities.
 */
@Repository
public interface VulnerabilityFlagRepository extends JpaRepository<VulnerabilityFlag, Long> {
    
    /**
     * Find vulnerability flags by OWASP category.
     * 
     * @param owaspCategory The OWASP category to search for
     * @return A list of vulnerability flags in the given category
     */
    List<VulnerabilityFlag> findByOwaspCategory(String owaspCategory);
    
    /**
     * Find vulnerability flags by difficulty.
     * 
     * @param difficulty The difficulty to search for
     * @return A list of vulnerability flags with the given difficulty
     */
    List<VulnerabilityFlag> findByDifficulty(VulnerabilityFlag.Difficulty difficulty);
    
    /**
     * Find a vulnerability flag by flag UUID.
     * 
     * @param flagUuid The flag UUID to search for
     * @return An Optional containing the vulnerability flag if found
     */
    Optional<VulnerabilityFlag> findByFlagUuid(String flagUuid);
    
    /**
     * Find a vulnerability flag by vulnerability name.
     * 
     * @param vulnerabilityName The vulnerability name to search for
     * @return An Optional containing the vulnerability flag if found
     */
    Optional<VulnerabilityFlag> findByVulnerabilityName(String vulnerabilityName);
}
